# Обработка аргументов

Аргументы, переданные при запуске программы, сохраняются в массиве ARGV.

## Файлы

Программы, работающие с файлами, могут принимать как по одному файлу, так и несколько сразу. Для работы с одним файлом используется массив ARGV, а для работы с несколькими файлами - поток ARGF.

### ARGV

Для чтения файла, переданного при запуске программы, используются частные методы экземпляров `kernel.gets` и `kernel.readline`. Они аналогичны соответствующим методам для чтения строк из потока.

### ARGF

**Добавленные модули: Enumerable**

ARGF ($<) - это поток, открываемый для всех файлов, содержащихся в ARGV. При этом подразумевается, что ARGV содержит только пути к файлам.

Файлы обрабатываются в том порядке, в котором они содержатся в ARGV (порядок, в котором они были переданы при запуске). После обработки путь к файлу удаляется автоматически.

Файлы обрабатываются последовательно в виде одного виртуального файла. Концом потока считается конец последнего файла, а не конец отдельных элементов.

Если ARGV ссылается на пустой массив, то ARGF ссылается на стандартный поток для чтения.

#### Управление потоком

Для управления потоком используются методы класса. Они аналогичны соответствующим методам для управления потоком.

+ `ARGF::binmode`
+ `ARGF::close` (обработка всех файлов считается исключением `IOError`)
+ `ARGF::skip` (при отсутствии файлов ничего не выполняется)
+ `ARGF::binmode?`
+ `ARGF::closed?`
+ `ARGF::eof?` (Синонимы: `eof`)

`::argv # -> ARGV`

`::filename # -> path`  
Синонимы: `path`

Относительный путь к обрабатываемому файлу. При взаимодействии с стандартным потоком для ввода возвращается `"-"`. Аналогично использованию $FILENAME.

#### Кодировка

Для изменения кодировки используются методы класса. Они аналогичны соответствующим методам для изменения кодировки потока.

+ `ARGF::external_encoding`
+ `ARGF::internal_encoding`
+ `ARGF::set_encoding`

#### Приведение типов

`::to_s # -> "ARGF"`

`::to_io # -> io`  
Синонимы: `file`

Используется для получения потока для обрабатываемого файла (или стандартного потока для ввода).

`::to_i # -> integer`  
Синонимы: `fileno`

Используется для получения дескриптора обрабатываемого файла. Отсутствие файлов считается исключением `ArgumentError`.

`::to_a( sep = $/, size = nil ) # -> array`  
Синонимы: `readlines`

Используется для извлечения всех строк и сохранения их в индексном массиве (размер массива может быть ограничен). Переданный разделитель обрабатывается в качестве символа перевода строки (если передается пустой текст, то обрабатывается "\n\n").

`::to_write_io # -> io`

Используется для получения потока, доступного для записи (только если используется режим редактирования файлов - при запуске программы передан ключ `-i`).

#### Чтение данных

Для чтения содержимого используются методы класса. Они аналогичны соответствующим методам для чтения содержимого потока.

Фрагменты:

+ `ARGF::read`
+ `ARGF::read_nonblock`
+ `ARGF::readpartial`

Строки:

+ + `ARGF::gets`
+ + `ARGF::readline`
+ + `ARGF::lineno`
+ + `ARGF::lineno=(pos)`
+ + `ARGF::seek`
+ + `ARGF::rewind`

Символы:

+ `ARGF::getc`
+ `ARGF::readchar`

Байты:

+ `ARGF::getbyte`
+ `ARGF::readbyte`
+ `ARGF::pos` (Синонимы: `tell`)
+ `ARGF::pos=(pos)`

Итераторы:

+ `ARGF::each` (Синонимы: `each_line, lines`)
+ `ARGF::bytes` (Синонимы: `each_byte`)
+ `ARGF::chars` (Синонимы: `each_char`)
+ `ARGF::codepoints` (Синонимы: `each_codepoint`, Ruby 2.0)

#### Запись данных

Запись данных с помощью ARGF возможна только при запуске программы с ключом `-i`. Запись данных выполняется относительно текущего обрабатываемого файла. Для записи используются методы класса. Они аналогичны соответствующим методам для записи данных в поток.

`::inplace_mode # -> string`

Расширение, применяемое при создании резервных копий изменяемых файлов.

`::inplace_mode=(ext) # -> self`

Используется для изменения расширения, применяемого при создании резервных копий изменяемых файлов.

+ `ARGF::write`
+ `ARGF::print`
+ `ARGF::printf`
+ `ARGF::putc`
+ `ARGF::puts`